<idea-plugin>
  <extensionPoints>
    <extensionPoint qualifiedName="icu.windea.pls.paradoxLocalScriptedVariableSearch" interface="com.intellij.util.QueryExecutor" dynamic="true"/>
    <extensionPoint qualifiedName="icu.windea.pls.paradoxGlobalScriptedVariableSearch" interface="com.intellij.util.QueryExecutor" dynamic="true"/>
    <extensionPoint qualifiedName="icu.windea.pls.paradoxDefinitionSearch" interface="com.intellij.util.QueryExecutor" dynamic="true"/>
    
    <extensionPoint qualifiedName="icu.windea.pls.paradoxValueSetValuesSearch" interface="com.intellij.util.QueryExecutor" dynamic="true"/>
    <extensionPoint qualifiedName="icu.windea.pls.paradoxComplexEnumValueSearch" interface="com.intellij.util.QueryExecutor" dynamic="true"/>
  </extensionPoints>
  
  <extensions defaultExtensionNs="com.intellij">
    <applicationConfigurable id="settings.language.pls" groupId="language" instance="icu.windea.pls.core.settings.ParadoxSettingsConfigurable"/>
    <applicationService serviceImplementation="icu.windea.pls.core.settings.ParadoxSettings"/>

    <projectService serviceInterface="com.intellij.psi.impl.ResolveScopeManager"
                    serviceImplementation="icu.windea.pls.core.psi.impl.ParadoxResolveScopeManager" overrides="true"/>
    
    <!--suppress PluginXmlValidity -->
    <fileTypeOverrider implementation="icu.windea.pls.core.ParadoxFileTypeOverrider"/>
    <utf8BomOptionProvider implementation="icu.windea.pls.core.ParadoxUtf8BomOptionProvider"/>
    
    <registryKey key="indexing.paradox.file.path.over.vfs" defaultValue="true" restartRequired="true"
                 description="Use VFS-based implementation for ParadoxFilePathIndex"/>
    <registryKey key="run.convert.dds.to.png.under.progress" defaultValue="true" restartRequired="true"
                 description="Run convert DDS to PNG write action under progress, not to freeze the UI during long operations"/>

    <library.type implementation="icu.windea.pls.core.library.ParadoxLibraryType"/>
    
    <!--<preloadingActivity implementation="icu.windea.pls.core.ParadoxPreloadActivity"/>-->
    
    <qualifiedNameProvider implementation="icu.windea.pls.core.ParadoxQualifiedNameProvider"/>
    <vfs.asyncListener implementation="icu.windea.pls.core.DescriptorOrMarkerFileListener"/>

    <readWriteAccessDetector implementation="icu.windea.pls.core.codeInsight.highlight.ParadoxReadWriteAccessDetector"/>
    <usageTypeProvider implementation="icu.windea.pls.core.codeInsight.highlight.ParadoxUsageTypeProvider"/>
    
    <applicationService serviceImplementation="icu.windea.pls.core.settings.ParadoxFoldingSettings"/>
    <codeFoldingOptionsProvider instance="icu.windea.pls.core.editor.ParadoxFoldingOptionsProvider"/>
    
    <fileBasedIndex implementation="icu.windea.pls.core.index.ParadoxFilePathIndexImpl"/>
    <fileBasedIndex implementation="icu.windea.pls.core.index.ParadoxValueSetValueIndex"/>
    
    <stubIndex implementation="icu.windea.pls.core.index.ParadoxScriptedVariableNameIndex"/>
    <stubIndex implementation="icu.windea.pls.core.index.ParadoxDefinitionNameIndex"/>
    <stubIndex implementation="icu.windea.pls.core.index.ParadoxDefinitionTypeIndex"/>
    <stubIndex implementation="icu.windea.pls.core.index.ParadoxComplexEnumIndex"/>
    <stubIndex implementation="icu.windea.pls.core.index.ParadoxValueSetValueIndex"/>
    <stubIndex implementation="icu.windea.pls.core.index.ParadoxLocalisationNameIndex"/>
    <stubIndex implementation="icu.windea.pls.core.index.ParadoxSyncedLocalisationNameIndex"/>
    
    <definitionsScopedSearch implementation="icu.windea.pls.core.search.implementations.ParadoxScriptedVariableImplementationsSearch"/>
    <definitionsScopedSearch implementation="icu.windea.pls.core.search.implementations.ParadoxDefinitionImplementationsSearch"/>
    <definitionsScopedSearch implementation="icu.windea.pls.core.search.implementations.ParadoxLocalisationImplementationsSearch"/>
    
    <referencesSearch implementation="icu.windea.pls.core.search.usages.ParadoxDefinitionUsagesSearcher"/>
    <referencesSearch implementation="icu.windea.pls.core.search.usages.ParadoxComplexEnumValueUsagesSearcher"/>
    <referencesSearch implementation="icu.windea.pls.core.search.usages.ParadoxLocalisationUsagesSearcher"/>
    <referencesSearch implementation="icu.windea.pls.core.search.usages.CwtAliasUsagesSearcher"/>
    
    <notificationGroup id="pls" displayType="BALLOON" isLogByDefault="true" bundle="messages.PlsBundle" key="notificationGroup.pls"/>
    
    <iconDescriptionBundle resourceBundle="messages.PlsIconBundle"/>
  </extensions>
  
  <extensions defaultExtensionNs="icu.windea.pls">
    <paradoxLocalScriptedVariableSearch implementation="icu.windea.pls.core.search.ParadoxLocalScriptedVariableSearcher"/>
    <paradoxGlobalScriptedVariableSearch implementation="icu.windea.pls.core.search.ParadoxGlobalScriptedVariableSearcher"/>
    <paradoxDefinitionSearch implementation="icu.windea.pls.core.search.ParadoxDefinitionSearcher"/>
    
    <paradoxComplexEnumValueSearch implementation="icu.windea.pls.core.search.ParadoxComplexEnumValueSearcher"/>
    <paradoxValueSetValuesSearch implementation="icu.windea.pls.core.search.ParadoxValueSetValueSearcher"/>
  </extensions>
  
  <actions>
    <action id="FileChooser.Pls.GotoSteamPath" class="icu.windea.pls.core.actions.GotoSteamPathAction">
      <add-to-group group-id="FileChooserToolbar" anchor="last"/>
    </action>
    <action id="FileChooser.Pls.GotoSteamGamePath" class="icu.windea.pls.core.actions.GotoSteamGamePathAction">
      <add-to-group group-id="FileChooserToolbar" anchor="last"/>
    </action>
    <action id="FileChooser.Pls.GotoSteamWorkshopPath" class="icu.windea.pls.core.actions.GotoSteamWorkshopPathAction">
      <add-to-group group-id="FileChooserToolbar" anchor="last"/>
    </action>
    <action id="FileChooser.Pls.GotoGameModPath" class="icu.windea.pls.core.actions.GotoGameModPathAction">
      <add-to-group group-id="FileChooserToolbar" anchor="last"/>
    </action>
  </actions>
</idea-plugin>
